<!DOCTYPE html>
<html>
<head>
    <title>Nostr WebRTC Signaling (v2.15.0)</title>
    
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        input[type="text"] { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
        button { padding: 8px 15px; margin: 5px 0; cursor: pointer; }
        #messages { width: 100%; height: 200px; }
        #status { padding: 10px; margin: 10px 0; background: #f0f0f0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Nostr WebRTC 通訊 (v2.15.0)</h1>
    
    <div class="section">
        <h2>Nostr 設定</h2>
        <button id="generateKeys">生成新密鑰</button>
        <div>
            <label for="privateKey">私鑰 (nsec):</label>
            <input type="text" id="privateKey" placeholder="nsec1...">
        </div>
        <div>
            <label for="publicKey">公鑰 (npub1...):</label>
            <input type="text" id="publicKey" readonly>
        </div>
        <div>
            <label for="relayUrl">Relay URL:</label>
            <input type="text" id="relayUrl" value="wss://relay.damus.io">
        </div>
        <div>
            <label for="targetPubkey">目標公鑰 (npub1...):</label>
            <input type="text" id="targetPubkey" placeholder="npub1...">
        </div>
        <button id="connect">連接</button>
        <button id="disconnect" disabled>斷開連接</button>
    </div>
    
    <div class="section">
        <h2>通訊</h2>
        <textarea id="messages" rows="10" readonly></textarea><br>
        <input type="text" id="messageInput" placeholder="輸入訊息...">
        <button id="sendMessage" disabled>發送</button>
    </div>
    
    <div class="section">
        <h2>狀態</h2>
        <div id="status">未連接</div>
    </div>

    <script>
        import * as nostr from 'https://esm.run/nostr-tools';
        console.log(nostr)
        // 全局變量
        let nostrPrivateKey = '';
        let nostrPublicKey = '';
        let relay = null;
        let subscription = null;
        let targetPubkey = '';
        
        // WebRTC 變量
        let peerConnection = null;
        let dataChannel = null;
        
        // DOM 元素
        const messagesTextarea = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendMessageButton = document.getElementById('sendMessage');
        const statusDiv = document.getElementById('status');
        const generateKeysButton = document.getElementById('generateKeys');
        const connectButton = document.getElementById('connect');
        const disconnectButton = document.getElementById('disconnect');
        const privateKeyInput = document.getElementById('privateKey');
        const publicKeyInput = document.getElementById('publicKey');
        const relayUrlInput = document.getElementById('relayUrl');
        const targetPubkeyInput = document.getElementById('targetPubkey');
        
       
    </script>
</body>
</html>
